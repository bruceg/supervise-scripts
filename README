supervise-scripts
version 3.0
2000-11-21
Copyright (C) 2000
Bruce Guenter <bruceg@em.ca>
http://em.ca/~bruceg/supervise-scripts/

This package is a set of scripts that may be useful for starting and
stopping programs that are managed by supervise and svscan, which are
part of the daemontools package.

daemontools was written by D. J. Bernstein <djb@pobox.com> and can be
found at http://cr.yp.to/daemontools.html
I have source and binary RPMs available at
http://em.ca/~bruceg/rpms/daemontools/

Installing
----------

These scripts expect svscan to be started by init.  To do this, run
"make install-config".  After you have done this step, or if you are
installing from the RPM, you need to make init start svscan.  You can do
this by either rebooting, or by typing "kill -1 1" to make init re-read
its configuration file.

Upgrading
---------

supervise-scripts version 3 is functionally compatible with version 2
and up.  No changes to startup scripts should be necessary.

You will, however, need to ensure that the old svscan process is
stopped.  Doing so will also stop all running services.

Tool Descriptions
-----------------

svc-isup checks if a service is running by filtering the output of svc.
svc-isdown checks if a service is not running.

svc-waitup waits for a service to start running, according to svc-isup,
printing a "." for each second it waits.  svc-waitdown waits for a
service to stop running.

svc-start starts a service by:
- setting up a link in /service to /var/service/SERVICE
- wait for supervise to start on the service's log
- force up the service's log
- wait for the service's log to come up
- wait for supervise to start on the service itself
- force up the service
- wait for the service to come up

svc-stop stops a service and waits for it to stop running by:
- marking the service as down
- running svc to down the service
- waiting for the service to come down
- marking the service's log as down
- running svc to down the service's log
- waiting for the service's log to come down
- if the service is symlinked into /service:
  - removing the symlink
  - stopping the supervise process

svc-status a message regarding the status of a service and its log
service.

All of the scripts change directory into "$SVSCANDIR", or /service
if it is not set, before executing.

svc-waitup and svc-waitdown will timeout after $SVCTIMEOUT seconds, or
15 if it is not set.

svc-start and svc-stop make their symlinks into the directory named by
the contents of $SVSCANDIR, or /service if it is not set.

Copyright
---------

    This package is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This package is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this package; if not, write to the Free Software
    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
